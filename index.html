<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sky Hopper</title>
<meta name="description" content="A simple flappy-style game. Progress autosaves in your browser." />
<style>
  html,body{margin:0;padding:0;background:#7fc7ff;font-family:monospace}
  .wrap{max-width:900px;margin:0 auto;padding:12px}
  h1{text-align:center;margin:8px 0}
  canvas{display:block;width:100%;height:auto;border-radius:8px;image-rendering:pixelated;background:#9fd9ff}
  .hud{display:flex;justify-content:space-between;margin:6px 0;font-size:14px}
  .center{text-align:center;margin-top:6px;color:#042533}
</style>
</head>
<body>
<div class="wrap">
  <h1>Sky Hopper</h1>
  <div class="hud">
    <div>Score: <span id="score">0</span></div>
    <div>Highest score: <span id="best">0</span></div>
  </div>
  <canvas id="game" width="800" height="500"></canvas>
  <div class="center">Tap or press Space to fly</div>
</div>

<script>
// ===== Simple Flappy Birdâ€“style Sky Hopper =====
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const scoreEl = document.getElementById('score');
const bestEl = document.getElementById('best');

const STORAGE_KEY = 'skyhopper-simple-best';
let bestScore = Number(localStorage.getItem(STORAGE_KEY) || 0);
bestEl.textContent = bestScore;

const GRAVITY = 1200;
const FLAP = -420;
const SPEED = 220;
const GAP = 220;
const PIPE_WIDTH = 80;
const SPAWN_INTERVAL = 1500;

let player, pipes, score, running, lastSpawn, lastTime;

function reset(){
  player = { x: 160, y: canvas.height/2, vy: 0, w: 28, h: 20 };
  pipes = [];
  score = 0;
  running = false;
  lastSpawn = 0;
  scoreEl.textContent = 0;
}

function start(){ reset(); running = true; }

function spawnPipe(){
  const minTop = 40;
  const maxTop = canvas.height - GAP - 40;
  const gapY = minTop + Math.random() * (maxTop - minTop);
  pipes.push({ x: canvas.width + 60, gapY });
}

function update(dt){
  if(!running) return;

  lastSpawn += dt;
  if(lastSpawn > SPAWN_INTERVAL){ lastSpawn = 0; spawnPipe(); }

  // player physics
  player.vy += GRAVITY * dt/1000;
  player.y += player.vy * dt/1000;

  // pipes
  for(let i=pipes.length-1;i>=0;i--){
    pipes[i].x -= SPEED * dt/1000;
    if(pipes[i].x + PIPE_WIDTH < 0){ pipes.splice(i,1); score++; scoreEl.textContent = score; }
  }

  // collisions
  if(player.y < 0 || player.y + player.h > canvas.height){ end(); }

  for(const p of pipes){
    if(player.x + player.w > p.x && player.x < p.x + PIPE_WIDTH){
      if(player.y < p.gapY || player.y + player.h > p.gapY + GAP){ end(); }
    }
  }
}

function end(){
  running = false;
  if(score > bestScore){ bestScore = score; localStorage.setItem(STORAGE_KEY, bestScore); bestEl.textContent = bestScore; }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // background
  const bg = ctx.createLinearGradient(0,0,0,canvas.height);
  bg.addColorStop(0,'#bfe9ff');
  bg.addColorStop(1,'#7fc7ff');
  ctx.fillStyle = bg;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // pipes (simple sky pillars)
  ctx.fillStyle = '#3b6ea5';
  for(const p of pipes){
    ctx.fillRect(p.x, 0, PIPE_WIDTH, p.gapY);
    ctx.fillRect(p.x, p.gapY + GAP, PIPE_WIDTH, canvas.height);
  }

  // player (simple bird)
  ctx.fillStyle = '#e33a2b';
  ctx.fillRect(player.x, player.y, player.w, player.h);
}

function loop(ts){
  if(!lastTime) lastTime = ts;
  const dt = ts - lastTime;
  lastTime = ts;
  update(dt);
  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

function flap(){ if(!running) start(); player.vy = FLAP; }

canvas.addEventListener('mousedown', flap);
window.addEventListener('keydown', e=>{ if(e.code==='Space'){ e.preventDefault(); flap(); }});

reset();
</script>
</body>
</html>
